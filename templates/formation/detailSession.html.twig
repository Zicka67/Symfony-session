{% extends 'base.html.twig' %}

{% block title %}{{ session.titlesection }}{% endblock %}

{% block body %}
<div class="flexTab">
  <div class="basic-tab">

    {# Tableau infos #}
    <table class="tabDetailSession">

      <thead>
        <tr>
          <th colspan="2">Informations</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="text-center">Professeur :</td>
          <td class="margin text-center">{{ session.former.firstName }} {{ session.former.lastName }}</td>
        </tr>
        <tr>
          <td class="text-center">Date de début :</td>
          <td class="reset text-center">{{ session.dateBegin|date('d/m/Y') }}</td>
        </tr>
        <tr>
          <td class="text-center">Date de fin :</td>
          <td class="reset text-center">{{ session.dateEnd|date('d/m/Y') }}</td>
        </tr>
        <tr>
          <td class="text-center">Nombre de places total :</td>
          <td class="reset text-center">{{ session.nbPlaces }}</td>
        </tr>
        <tr>
          <td class="text-center">Nombre de places disponibles :</td>
          <td class="text-center">{{ session.nbPlaces - session.students|length }}/{{ session.nbPlaces }}</td>
        </tr>
      </tbody>

    </table>

  </div>

  {# tableau student #}
  
  {% if session.students is not empty %}
    <div class="basic-tab">

      <table class="tabDetailSession">

        <thead>
          <tr>
            <th colspan="2">Liste des stagiaires inscrits ({{ session.students|length }}) :</th>
          </tr>
        </thead>
        <tbody>
          {# On parcours la collections de stagiaire(students) de session avec une condition pour vérifier si ell eest vide #}
          {% for student in session.students %}
            <tr>
              {% if 'ROLE_ADMIN' in app.user.roles %}
              <td><a class="reset" href="{{ path('app_showDetailsStudent', {'id': student.id}) }}">{{ student.firstName }} {{ student.lastName }}</a></td>
              <td><a class="reset red" href="{{ path('app_removeStudentFromSession', {'sessionId': session.id, 'studentId': student.id}) }}" >Supprimer</a></td>
              {% else %}
              <td><p class="reset" href="{{ path('app_showDetailsStudent', {'id': student.id}) }}">{{ student.firstName }} {{ student.lastName }}</p></td>
              <td><p class="reset red" href="{{ path('app_removeStudentFromSession', {'sessionId': session.id, 'studentId': student.id}) }}" ></p></td>

              {% endif %}
            </tr>
          {% endfor %}
        </tbody>

      </table>

    </div>
  {% endif %}

  {% if 'ROLE_ADMIN' in app.user.roles %}
  {% if studentsNotInSession is defined and studentsNotInSession is not empty %}
  <div class="basic-tab">
    <table class="tabDetailSession">
      <thead>
        <tr>
          <th >Étudiants non inscrits ({{ studentsNotInSession|length }}) :</th>
        </tr>
      </thead>
      <tbody>
        {% for student in studentsNotInSession %}
        <tr>
          <td class="addingTd">{{ student.firstName }} {{ student.lastName }} <a class="green" href="{{ path('app_addStudentToSession', {'id': session.id, 'studentId': student.id}) }}">Ajouter</a></td>
        </tr> 
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
    <p>Aucun étudiant libre.</p>
  {% endif %}
  {% endif %}

  {# {% if modules is defined and modules is not empty %}
  {% for module in modules %}
    <div class="basic-tab">
        <table class="tabDetailSession">
            <thead>            
                <tr>
                    <th>Module :</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="addingTd">Nom du module : {{ module.titleModules }}</td>
                </tr> 
                <tr>
                    <td class="addingTd">De la category : {{ module.category.titleCategory }}</td>
                </tr> 
                {% for programme in module.programmes %}
                {# Pour empêcher d'avoir 2 durée #}
                {# {% if loop.first %} 
                <tr>
                    <td class="addingTd">Durée du programme : {{ programme.duree }} jours</td>
                </tr>
                {% endif %}
                {% endfor %}
            </tbody>
        </table>
    </div>
    <br>
  {% endfor %}
{% else %}
  <p>Aucun module programmé.</p>
{% endif %}
</div>  #}

{% if programmes is not empty %}
<div class="basic-tab">
    <table class="tabDetailSession">
        <thead>
            <tr>
                <th colspan="2">Modules pour cette session</th>
            </tr>
        </thead>
        <tbody>
            {% for programme in programmes %}
            <tr>
                <td>{{ programme.modules.titleModules }}</td>
                <td>{{ programme.duree }} jours</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}


{# <a href="{{ path('formation_sessions', {'id': formation.id, 'sessionId': session.id}) }}">Retour à la liste des sessions</a> #}
{# <br>
  <a href="{{ path('app_home') }}">Retour à l'accueil</a> #}
{% endblock %}
